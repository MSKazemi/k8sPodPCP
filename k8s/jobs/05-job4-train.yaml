# ===========================================
# JOB 4: Train power prediction model
# ===========================================
---
apiVersion: batch/v1
kind: Job
metadata:
  name: train-power
  namespace: energy
spec:
  backoffLimit: 1
  template:
    spec:
      restartPolicy: Never
      containers:
        - name: train
          image: ghcr.io/mskazemi/energetiscope:latest
          imagePullPolicy: Always
          args:
            - python3
            - /app/train_power.py
            - --train
            - /app/data/train_rows.parquet
            - --target
            - total_energy_j
            - --out
            - /app/data/knn_energy.joblib
          volumeMounts:
            - name: data
              mountPath: /app/data
      volumes:
        - name: data
          persistentVolumeClaim:
            claimName: energetiscope-data
